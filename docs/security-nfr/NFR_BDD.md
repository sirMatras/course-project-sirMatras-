# BDD Сценарии для нефункциональных требований безопасности (Security NFR)

## Функция: Безопасное хранение пароля

  **Сценарий:** Система хэширует пароль с использованием Argon2id  
  **Дано:** Пользователь регистрируется с email "test@example.com" и паролем "SecurePass123!"  
  **Когда:** Запрос на регистрацию обрабатывается  
  **Тогда:** Сохранённый хэш пароля должен использовать Argon2id с параметрами t=3, m=64MB, p=4  

  **Сценарий:** Система отклоняет использование слабого алгоритма хэширования  
  **Дано:** Модуль аутентификации неправильно настроен и использует SHA1  
  **Когда:** Проводится аудит безопасности  
  **Тогда:** CI-пайплайн должен завершиться ошибкой "Weak hashing algorithm detected"  

## Функция: Защита от чрезмерных запросов (Rate limiting)

  **Сценарий:** Законный пользователь остаётся в пределах лимита  
  **Дано:** Клиент отправляет 90 запросов за 60 секунд  
  **Когда:** Каждый запрос является корректным  
  **Тогда:** Все запросы должны возвращать HTTP 200  

  **Сценарий:** Брутфорс-атакующий блокируется  
  **Дано:** Клиент отправляет 150 запросов на вход за 60 секунд  
  **Когда:** Запросы содержат неверные учётные данные  
  **Тогда:** Ответы с 101-го по 150-й должны возвращать HTTP 429  

## Функция: Истечение срока действия JWT-токена

  **Сценарий:** Токен доступа истекает через 15 минут  
  **Дано:** Пользователь входит в систему и получает токен доступа  
  **Когда:** Проходит 16 минут  
  **И:** Пользователь использует токен для доступа к /profile  
  **Тогда:** Ответ должен быть HTTP 401 Unauthorized  
