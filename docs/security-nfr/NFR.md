# Security Non-Functional Requirements (NFR)

| ID | Название | Описание | Метрика/Порог | Проверка (чем/где) | Компонент | Приоритет |
|----|----------|----------|----------------|---------------------|----------|----------|
| SEC-01 | Хранение паролей | Пароли должны храниться в хэшированном виде с использованием современного алгоритма | Argon2id, t=3, m=64MB, p=4 | Анализ кода + unit-тесты | Auth Service | High |
| SEC-02 | Срок жизни JWT | Access-токены не должны жить дольше разумного | TTL ≤ 15 минут | Проверка заголовков ответа / интеграционные тесты | API Gateway | High |
| SEC-03 | Rate limiting | Защита от брутфорса и DDoS на уровне API | ≤ 100 запросов/мин с одного IP | Тесты нагрузки (Locust/k6), логи | API Gateway | Medium |
| SEC-04 | Уязвимости в зависимостях | В проекте не должно быть критических уязвимостей в пакетах | 0 уязвимостей уровня Critical/High старше 30 дней | `pip-audit`, `trivy`, GitHub Dependabot | CI Pipeline | Critical |
| SEC-05 | Ротация секретов | Секреты (API-ключи, токены) должны регулярно обновляться | Ротация каждые 90 дней (SLA) | Аудит конфигурации, проверка в Vault/1Password | Secrets Manager | High |
| SEC-06 | Логирование аутентификации | Все попытки входа (успешные и неуспешные) должны логироваться | 100% событий входа в логах | Проверка через тестовые запросы + grep логов | Auth Service | Medium |
| SEC-07 | HTTPS-only трафик | Весь трафик должен идти по TLS 1.2+ | Заголовок `Strict-Transport-Security` (HSTS) с max-age ≥ 31536000 | Сканер безопасности (nmap, sslyze) | Web Server | High |
| SEC-08 | CSP для фронтенда | Защита от XSS через Content Security Policy | Наличие заголовка `Content-Security-Policy` | Проверка в DevTools / автоматизированный сканер | Frontend | Medium |
