# ADR-002 — Ограничение частоты запросов для /auth/login

## Статус
Принято

## Контекст
Точки входа аутентификации — частые цели брутфорса и credential stuffing. Нужен базовый rate limiting для снижения риска злоупотреблений без тяжёлой инфраструктуры.

## Решение
- Внедрить лёгкий in-memory rate limiting для `/auth/login`, ключ — IP клиента.
- Политика: 5 запросов за 60 секунд на IP; превышение — 429 с RFC 7807.
- Оформить как зависимость FastAPI, чтобы легко заменить на Redis/NGINX в будущем.

## Последствия
- Снижает эффективность брутфорса на логин.
- В статeless-средах может понадобиться общий стор; интерфейс позволит безболезненный переход.

## Ссылки
- NFR-xx: безопасность и защита от злоупотреблений (P03)
- P04: F#/R# по угрозам аутентификации (STRIDE: D, E)
- Тесты: `tests/test_rate_limit.py`
- Закрывает риск: брутфорс логина (RISKS.md) — проверка через получение 429 после порога.


